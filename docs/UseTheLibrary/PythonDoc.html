
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The openbabel module &#8212; Open Babel openbabel-3-1-1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../../_static/documentation_options.js?v=4d45eed0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/UseTheLibrary/PythonDoc';</script>
    <link rel="canonical" href="https://openbabel.github.io/docs/UseTheLibrary/PythonDoc.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Pybel" href="Python_Pybel.html" />
    <link rel="prev" title="Install Python bindings" href="PythonInstall.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Open Babel</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/openbabel/openbabel" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/OpenBabel" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/openbabel/openbabel" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/OpenBabel" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation/install.html">Install Open Babel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Command-line_tools/babel.html">obabel - Convert, Filter and Manipulate Chemical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GUI/GUI.html">The Open Babel GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GUITutorial/GUITutorial.html">Tutorial on using the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fingerprints/intro.html">Molecular fingerprints and similarity searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Command-line_tools/Rosetta.html">obabel vs Chemistry Toolkit Rosetta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Depiction/depiction.html">2D Depiction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3DStructureGen/Overview.html">3D Structure Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Forcefields/Overview.html">Molecular Mechanics and Force Fields</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Write software using the Open Babel library</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="CppAPI.html">The Open Babel API</a></li>
<li class="toctree-l2"><a class="reference internal" href="CppExamples.html">C++</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="Python.html">Python</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="PythonIntro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="PythonInstall.html">Install Python bindings</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">The openbabel module</a></li>
<li class="toctree-l3"><a class="reference internal" href="Python_Pybel.html">Pybel</a></li>
<li class="toctree-l3"><a class="reference internal" href="Python_PybelAPI.html">Pybel API</a></li>
<li class="toctree-l3"><a class="reference internal" href="PythonExamples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Java.html">Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="Perl.html">Perl</a></li>
<li class="toctree-l2"><a class="reference internal" href="CSharp.html">CSharp and OBDotNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="Ruby.html">Ruby</a></li>
<li class="toctree-l2"><a class="reference internal" href="migration.html">Updating to Open Babel 3.0 from 2.x</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Cheminf101/index.html">Cheminformatics 101</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Stereochemistry/stereo.html">Stereochemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Aromaticity/Aromaticity.html">Handling of aromaticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Features/Radicals.html">Radicals and SMILES extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributing/Contributing.html">Contributing to Open Babel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WritePlugins/index.html">Adding plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FileFormats/Overview.html">Supported File Formats and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Descriptors/descriptors.html">Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Charges/charges.html">Charge models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ReleaseNotes/index.html">Release Notes</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="Python.html" class="nav-link">Python</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">The openbabel module</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="the-openbabel-module">
<span id="openbabel-python-module"></span><h1>The openbabel module<a class="headerlink" href="#the-openbabel-module" title="Link to this heading">#</a></h1>
<p>The <strong>openbabel</strong> module provides direct access to the C++ Open
Babel library from Python. This binding is generated using the SWIG
package and provides access to almost all of the Open Babel
interfaces via Python, including the base classes OBMol, OBAtom,
OBBond, and OBResidue, as well as the conversion framework
OBConversion. As such, essentially any call in the C++ API is
available to Python scripts with very little difference in syntax.
As a result, the principal documentation is the
<a class="reference internal" href="../../api/index.html#api"><span class="std std-ref">C++ API documentation</span></a>.</p>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<p>Here we give some examples of common Python syntax for the
<code class="docutils literal notranslate"><span class="pre">openbabel</span></code> module and pointers to the appropriate sections of
the API documentation.</p>
<p>The example script below creates atoms and bonds one-by-one using
the
<a href="#id1"><span class="problematic" id="id2">:obapi:`OBMol`</span></a>, <a href="#id3"><span class="problematic" id="id4">:obapi:`OBAtom`</span></a>, and <a href="#id5"><span class="problematic" id="id6">:obapi:`OBBond`</span></a> classes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">openbabel</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMol</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumAtoms</span><span class="p">())</span> <span class="c1">#Should print 0 (atoms)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">NewAtom</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">SetAtomicNum</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>   <span class="c1"># carbon atom</span>
<span class="n">a</span><span class="o">.</span><span class="n">SetVector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span> <span class="c1"># coordinates</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">NewAtom</span><span class="p">()</span>
<span class="n">mol</span><span class="o">.</span><span class="n">AddBond</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># atoms indexed from 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumAtoms</span><span class="p">())</span> <span class="c1">#Should print 2 (atoms)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumBonds</span><span class="p">())</span> <span class="n">Should</span> <span class="nb">print</span> <span class="mi">1</span> <span class="p">(</span><span class="n">bond</span><span class="p">)</span>

<span class="n">mol</span><span class="o">.</span><span class="n">Clear</span><span class="p">();</span>
</pre></div>
</div>
<p>More commonly, Open Babel can be used to read in molecules using
the <a href="#id7"><span class="problematic" id="id8">:obapi:`OBConversion`</span></a>
framework. The following script reads in molecular information (a
SMI file) from a string, adds hydrogens, and writes out an MDL file
as a string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">openbabel</span>

<span class="n">obConversion</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBConversion</span><span class="p">()</span>
<span class="n">obConversion</span><span class="o">.</span><span class="n">SetInAndOutFormats</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="s2">&quot;mdl&quot;</span><span class="p">)</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMol</span><span class="p">()</span>
<span class="n">obConversion</span><span class="o">.</span><span class="n">ReadString</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;C1=CC=CS1&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumAtoms</span><span class="p">())</span> <span class="c1">#Should print 5 (atoms)</span>

<span class="n">mol</span><span class="o">.</span><span class="n">AddHydrogens</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumAtoms</span><span class="p">())</span> <span class="n">Should</span> <span class="nb">print</span> <span class="mi">9</span> <span class="p">(</span><span class="n">atoms</span><span class="p">)</span> <span class="n">after</span> <span class="n">adding</span> <span class="n">hydrogens</span>

<span class="n">outMDL</span> <span class="o">=</span> <span class="n">obConversion</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</pre></div>
</div>
<p>The following script writes out a file using a filename, rather
than reading and writing to a Python string.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">openbabel</span>

<span class="n">obConversion</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBConversion</span><span class="p">()</span>
<span class="n">obConversion</span><span class="o">.</span><span class="n">SetInAndOutFormats</span><span class="p">(</span><span class="s2">&quot;pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;mol2&quot;</span><span class="p">)</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMol</span><span class="p">()</span>
<span class="n">obConversion</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;1ABC.pdb.gz&quot;</span><span class="p">)</span>   <span class="c1"># Open Babel will uncompress automatically</span>

<span class="n">mol</span><span class="o">.</span><span class="n">AddHydrogens</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumAtoms</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumBonds</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">NumResidues</span><span class="p">())</span>

<span class="n">obConversion</span><span class="o">.</span><span class="n">WriteFile</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s1">&#39;1abc.mol2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-iterators">
<h2>Using iterators<a class="headerlink" href="#using-iterators" title="Link to this heading">#</a></h2>
<p>A number of Open Babel toolkit classes provide iterators over
various objects; these classes are identifiable by the suffix
“Iter” in the
<a class="reference external" href="http://openbabel.sourceforge.net/api/current/annotated.shtml">list of toolkit classes</a>
in the API:</p>
<ul class="simple">
<li><p><a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBAtomAtomIter.shtml">OBAtomAtomIter</a>
and
<a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBAtomBondIter.shtml">OBAtomBondIter</a>
- given an OBAtom, iterate over all neighboring OBAtoms or OBBonds</p></li>
<li><p><a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolAtomIter.shtml">OBMolAtomIter</a>,
<a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolBondIter.shtml">OBMolBondIter</a>,
<a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolAngleIter.shtml">OBMolAngleIter</a>,
<a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolTorsionIter.shtml">OBMolTorsionIter</a>,
<a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolRingIter.shtml">OBMolRingIter</a>
- given an OBMol, iterate over all OBAtoms, OBBonds, OBAngles,
OBTorsions or OBRings.</p></li>
<li><p><a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolAtomBFSIter.shtml">OBMolAtomBFSIter</a>
- given an OBMol and the index of an atom, OBMolAtomBFSIter
iterates over all the neighbouring atoms in a breadth-first manner.
It differs from the other iterators in that it returns two values -
an OBAtom, and the ‘depth’ of the OBAtom in the breadth-first
search (this is useful, for example, when creating circular
fingerprints)</p></li>
<li><p><a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBMolPairIter.shtml">OBMolPairIter</a>
- given an OBMol, iterate over all pairs of OBAtoms separated by
more than three bonds</p></li>
<li><p><a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBResidueIter.shtml">OBResidueIter</a>
- given an OBMol representing a protein, iterate over all
OBResidues</p></li>
<li><p><a class="reference external" href="http://openbabel.sourceforge.net/api/current/classOpenBabel_1_1OBResidueAtomIter.shtml">OBResidueAtomIter</a>
- given an OBResidue, iterate over all OBAtoms</p></li>
</ul>
<p>These iterator classes can be used using the typical Python syntax
for iterators:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">obatom</span> <span class="ow">in</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMolAtomIter</span><span class="p">(</span><span class="n">obmol</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obatom</span><span class="o">.</span><span class="n">GetAtomicMass</span><span class="p">())</span>
</pre></div>
</div>
<p>Note that OBMolTorsionIter returns atom IDs which are off by one.
That is, you need to add one to each ID to get the correct ID.
Also, if you add or remove atoms, you will need to delete the
existing TorsionData before using OBMolTorsionIter. This is done as
follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mol</span><span class="o">.</span><span class="n">DeleteData</span><span class="p">(</span><span class="n">openbabel</span><span class="o">.</span><span class="n">TorsionData</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="calling-a-method-requiring-an-array-of-c-doubles">
<h2>Calling a method requiring an array of C doubles<a class="headerlink" href="#calling-a-method-requiring-an-array-of-c-doubles" title="Link to this heading">#</a></h2>
<p>Some Open Babel toolkit methods, for example <a href="#id9"><span class="problematic" id="id10">:obapi:`OBMol::Rotate() &lt;OpenBabel::OBMol::Rotate&gt;`</span></a>,
require an array of doubles. It’s not possible to directly use a
list of floats when calling such a function from Python. Instead,
you need to first explicitly create a C array using the
<em>double_array()</em> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obMol</span><span class="o">.</span><span class="n">Rotate</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.7</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="c1"># Error!</span>
<span class="n">myarray</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">double_array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">54.7</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">obMol</span><span class="o">.</span><span class="n">Rotate</span><span class="p">(</span><span class="n">myarray</span><span class="p">)</span>
<span class="c1"># Works!</span>
</pre></div>
</div>
</section>
<section id="accessing-obpairdata-obunitcell-and-other-obgenericdata">
<h2>Accessing OBPairData, OBUnitCell and other OBGenericData<a class="headerlink" href="#accessing-obpairdata-obunitcell-and-other-obgenericdata" title="Link to this heading">#</a></h2>
<p>If you want to access any subclass of OBGenericData (such as <a href="#id11"><span class="problematic" id="id12">:obapi:`OBPairData`</span></a>
or <a href="#id13"><span class="problematic" id="id14">:obapi:`OBUnitCell`</span></a>)
associated with a molecule, you need to ‘cast’ the <a href="#id15"><span class="problematic" id="id16">:obapi:`OBGenericData`</span></a>
returned by <a href="#id17"><span class="problematic" id="id18">:obapi:`OBMol.GetData() &lt;OpenBabel::OBMol::GetData&gt;`</span></a> using the <em>toPairData()</em>, <em>toUnitCell()</em> (etc.)
functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pairdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">openbabel</span><span class="o">.</span><span class="n">toPairData</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">obMol</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">GetDataType</span><span class="p">()</span><span class="o">==</span><span class="n">openbabel</span><span class="o">.</span><span class="n">PairData</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pairdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">GetAttribute</span><span class="p">(),</span> <span class="n">pairdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>

<span class="n">unitcell</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">toUnitCell</span><span class="p">(</span><span class="n">obMol</span><span class="o">.</span><span class="n">GetData</span><span class="p">(</span><span class="n">openbabel</span><span class="o">.</span><span class="n">UnitCell</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">unitcell</span><span class="o">.</span><span class="n">GetAlpha</span><span class="p">(),</span> <span class="n">unitcell</span><span class="o">.</span><span class="n">GetSpaceGroup</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="using-fastsearch-from-python">
<h2>Using FastSearch from Python<a class="headerlink" href="#using-fastsearch-from-python" title="Link to this heading">#</a></h2>
<p>Rather than use the <a href="#id19"><span class="problematic" id="id20">:obapi:`FastSearch`</span></a> class directly, it’s easiest to use the <a href="#id21"><span class="problematic" id="id22">:obapi:`OpenInAndOutFiles() &lt;OpenBabel::OBConversion::OpenInAndOutFiles&gt;`</span></a> method as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">openbabel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">=</span><span class="n">openbabel</span><span class="o">.</span><span class="n">OBConversion</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">OpenInAndOutFiles</span><span class="p">(</span><span class="s2">&quot;1200mols.smi&quot;</span><span class="p">,</span><span class="s2">&quot;index.fs&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">SetInAndOutFormats</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span><span class="s2">&quot;fs&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">Convert</span><span class="p">()</span>
<span class="go">This will prepare an index of 1200mols.smi and may take some time...</span>
<span class="go">It took 6 seconds</span>
<span class="go">1192</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">CloseOutFile</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">OpenInAndOutFiles</span><span class="p">(</span><span class="s2">&quot;index.fs&quot;</span><span class="p">,</span><span class="s2">&quot;results.smi&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">SetInAndOutFormats</span><span class="p">(</span><span class="s2">&quot;fs&quot;</span><span class="p">,</span><span class="s2">&quot;smi&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">AddOption</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span><span class="n">conv</span><span class="o">.</span><span class="n">GENOPTIONS</span><span class="p">,</span><span class="s2">&quot;C=CC#N&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conv</span><span class="o">.</span><span class="n">Convert</span><span class="p">()</span>
<span class="go">10 candidates from fingerprint search phase</span>
<span class="go">1202</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;results.smi&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;OC(=O)C(=Cc1ccccc1)C#N\t298\nN#CC(=Cc1ccccc1)C#N\t490\nO=N(=O)c1cc(ccc1)C=C(C#N</span>
<span class="go">)C#N\t491\nClc1ccc(cc1)C=C(C#N)C#N\t492\nClc1ccc(c(c1)Cl)C=C(C#N)C#N\t493\nClc1c</span>
<span class="go">cc(cc1Cl)C=C(C#N)C#N\t494\nBrc1ccc(cc1)C=C(C#N)C#N\t532\nClc1ccccc1C=C(C#N)C#N\t</span>
<span class="go">542\nN#CC(=CC=Cc1occc1)C#N\t548\nCCOC(=O)C(C#N)=C(C)C\t1074\n&#39;</span>
</pre></div>
</div>
</section>
<section id="combining-numpy-with-open-babel">
<h2>Combining numpy with Open Babel<a class="headerlink" href="#combining-numpy-with-open-babel" title="Link to this heading">#</a></h2>
<p>If you are using the Python numerical extension, numpy, and you try
to pass values from a numpy array to Open Babel, it may not work
unless you convert the values to Python built-in types first:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">openbabel</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">openbabel</span><span class="o">.</span><span class="n">OBMol</span><span class="p">()</span>
<span class="n">atom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">NewAtom</span><span class="p">()</span>

<span class="n">coord</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">4.6</span><span class="p">],</span> <span class="s2">&quot;float32&quot;</span><span class="p">)</span>
<span class="n">atom</span><span class="o">.</span><span class="n">SetVector</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># Error</span>

<span class="n">atom</span><span class="o">.</span><span class="n">SetVector</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="c1"># No error</span>

<span class="n">coord</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">4.6</span><span class="p">],</span> <span class="s2">&quot;float64&quot;</span><span class="p">)</span>
<span class="n">atom</span><span class="o">.</span><span class="n">SetVector</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># No error either - not all numpy arrays will cause an error</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="PythonInstall.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Install Python bindings</p>
      </div>
    </a>
    <a class="right-next"
       href="Python_Pybel.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Pybel</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-iterators">Using iterators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calling-a-method-requiring-an-array-of-c-doubles">Calling a method requiring an array of C doubles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-obpairdata-obunitcell-and-other-obgenericdata">Accessing OBPairData, OBUnitCell and other OBGenericData</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-fastsearch-from-python">Using FastSearch from Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-numpy-with-open-babel">Combining numpy with Open Babel</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/openbabel/openbabel.github.io/edit/main/source/docs/UseTheLibrary/PythonDoc.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright ©2023 The Open Babel Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>