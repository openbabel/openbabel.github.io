
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Stereochemistry &#8212; Open Babel openbabel-3-1-1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="../../_static/documentation_options.js?v=4d45eed0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/Stereochemistry/stereo';</script>
    <link rel="canonical" href="https://openbabel.github.io/docs/Stereochemistry/stereo.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Handling of aromaticity" href="../Aromaticity/Aromaticity.html" />
    <link rel="prev" title="Chemical Registration Systems" href="../Cheminf101/registration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Open Babel</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/openbabel/openbabel" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/OpenBabel" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/openbabel/openbabel" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/OpenBabel" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Introduction/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation/install.html">Install Open Babel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Command-line_tools/babel.html">obabel - Convert, Filter and Manipulate Chemical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GUI/GUI.html">The Open Babel GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GUITutorial/GUITutorial.html">Tutorial on using the GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fingerprints/intro.html">Molecular fingerprints and similarity searching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Command-line_tools/Rosetta.html">obabel vs Chemistry Toolkit Rosetta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Depiction/depiction.html">2D Depiction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3DStructureGen/Overview.html">3D Structure Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Forcefields/Overview.html">Molecular Mechanics and Force Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UseTheLibrary/intro.html">Write software using the Open Babel library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Cheminf101/index.html">Cheminformatics 101</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Stereochemistry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Aromaticity/Aromaticity.html">Handling of aromaticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Features/Radicals.html">Radicals and SMILES extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Contributing/Contributing.html">Contributing to Open Babel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WritePlugins/index.html">Adding plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FileFormats/Overview.html">Supported File Formats and Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Descriptors/descriptors.html">Descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Charges/charges.html">Charge models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ReleaseNotes/index.html">Release Notes</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Stereochemistry</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="stereochemistry">
<h1>Stereochemistry<a class="headerlink" href="#stereochemistry" title="Link to this heading">#</a></h1>
<p>Open Babel stores stereochemistry as the relative arrangement of a set of atoms in space. For example, for a tetrahedral stereocenter, we store information like “looking from atom 2, atoms 4, 5 and 6 are arranged clockwise around atom 3”. This section describes how a user can work with or manipulate this information. This might be useful to invert a particular center, replace a substituent at a stereocenter, enumerate stereoisomers or determine the number of unspecified stereocenters.</p>
<p>Although Open Babel has data structures to support a variety of forms of stereochemistry, currently little use is made of any stereochemistry other than tetrahedral and cis/trans (and square planar to a certain degree).</p>
<p>We will look first of all at how stereochemistry information is stored, accessed, and modified. Then we describe how this information is deduced from the chemical structure. This chapter should be read in combination with the API documentation (see the Stereochemistry overview page found under “Modules”).</p>
<section id="accessing-stereochemistry-information">
<h2>Accessing stereochemistry information<a class="headerlink" href="#accessing-stereochemistry-information" title="Link to this heading">#</a></h2>
<p>Each record of stereochemistry information around an atom or bond is stored as StereoData associated with the OBMol. First of all, let’s look at direct access to the StereoData. The following code counts the number of tetrahedral centers with specified stereochemistry, as well as the number of double bonds with specified cis/trans stereochemistry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_cistrans</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_tetra</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readstring</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="s2">&quot;F/C=C/C[C@@H](Cl)Br&quot;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">OBMol</span>

<span class="k">for</span> <span class="n">genericdata</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">GetAllData</span><span class="p">(</span><span class="n">ob</span><span class="o">.</span><span class="n">StereoData</span><span class="p">):</span>
    <span class="n">stereodata</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">toStereoBase</span><span class="p">(</span><span class="n">genericdata</span><span class="p">)</span>
    <span class="n">stereotype</span> <span class="o">=</span> <span class="n">stereodata</span><span class="o">.</span><span class="n">GetType</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">stereotype</span> <span class="o">==</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereo</span><span class="o">.</span><span class="n">CisTrans</span><span class="p">:</span>
        <span class="n">cistrans</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">toCisTransStereo</span><span class="p">(</span><span class="n">stereodata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cistrans</span><span class="o">.</span><span class="n">IsSpecified</span><span class="p">():</span>
            <span class="n">num_cistrans</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">elif</span> <span class="n">stereotype</span> <span class="o">==</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereo</span><span class="o">.</span><span class="n">Tetrahedral</span><span class="p">:</span>
        <span class="n">tetra</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">toTetrahedralStereo</span><span class="p">(</span><span class="n">stereodata</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tetra</span><span class="o">.</span><span class="n">IsSpecified</span><span class="p">():</span>
            <span class="n">num_tetra</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<aside class="sidebar">
<p class="sidebar-title">Atom and Bond Ids</p>
<p>All of the stereo handling code uses Ids to reference atoms and bonds, rather than indices. An Open Babel atom has an index (<code class="docutils literal notranslate"><span class="pre">OBAtom::GetIdx()</span></code>) and an Id (<code class="docutils literal notranslate"><span class="pre">OBAtom::GetId()</span></code>). The former runs from 1 to the number of atoms. The latter can be anything (don’t assume it’s the Idx-1), but is unique within the molecule. If you delete an atom, the indices change, but the Ids do not. For this reason, all stereo is stored using Ids so that stereo information is not invalidated by changes to the molecule. When the stereochemistry description involves implicit hydrogens or lone pairs, the special atom Id <code class="docutils literal notranslate"><span class="pre">OBStereo::ImplicitRef</span></code> (numerically, <code class="docutils literal notranslate"><span class="pre">-2</span></code> or <code class="docutils literal notranslate"><span class="pre">4294967294</span></code> if accessed via the bindings) is used.</p>
</aside>
<p>The code above is quite verbose, and requires iteration through all of the stereo data. To make it simpler to access stereo data for a particular atom or bond, a facade class OBStereoFacade can instead be used, which provides convenience functions for these operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">num_cistrans</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">num_tetra</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readstring</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="s2">&quot;F/C=C/C[C@@H](Cl)Br&quot;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">OBMol</span>

<span class="n">facade</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereoFacade</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBMolAtomIter</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">facade</span><span class="o">.</span><span class="n">HasTetrahedralStereo</span><span class="p">(</span><span class="n">mid</span><span class="p">):</span>
        <span class="n">tetra</span> <span class="o">=</span> <span class="n">facade</span><span class="o">.</span><span class="n">GetTetrahedralStereo</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tetra</span><span class="o">.</span><span class="n">IsSpecified</span><span class="p">():</span>
            <span class="n">num_tetra</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBMolBondIter</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="n">bond</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">facade</span><span class="o">.</span><span class="n">HasCisTransStereo</span><span class="p">(</span><span class="n">mid</span><span class="p">):</span>
        <span class="n">cistrans</span> <span class="o">=</span> <span class="n">facade</span><span class="o">.</span><span class="n">GetCisTransStereo</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cistrans</span><span class="o">.</span><span class="n">IsSpecified</span><span class="p">():</span>
            <span class="n">num_cistrans</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Note that every time you create a new OBStereoFacade, a certain amount of work is done building up the correspondance between atoms/bonds and stereo data. For this reason, a single OBStereoFacade should be created for a molecule and reused.</p>
</section>
<section id="the-config-object">
<h2>The Config() object<a class="headerlink" href="#the-config-object" title="Link to this heading">#</a></h2>
<p>The description of the stereochemical configuration is accessed via a Config() object associated with each StereoData. The contents of this object will be different depending on the specific type of stereochemistry, e.g. <code class="docutils literal notranslate"><span class="pre">OBCisTransStereo::Config</span></code> (<code class="docutils literal notranslate"><span class="pre">OBCisTransConfig</span></code> from Python) records the begin and end Ids of the associated bond, the Ids of the attached atoms, the spatial relationship of those atoms, and whether stereo is specified.</p>
<p>Let’s read the SMILES string <code class="docutils literal notranslate"><span class="pre">F[C&#64;&#64;](Cl)(Br)I</span></code> and access the stereo. When we read this SMILES string, the tetrahedral center will be the second atom, that with Idx 2.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smi</span> <span class="o">=</span> <span class="s2">&quot;F[C@@](Cl)(Br)I&quot;</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readstring</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="n">smi</span><span class="p">)</span><span class="o">.</span><span class="n">OBMol</span>
<span class="n">secondatom</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">GetAtom</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">atomid</span> <span class="o">=</span> <span class="n">secondatom</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>

<span class="n">stereofacade</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereoFacade</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Does this atom have tet stereo info?&quot;</span><span class="p">,</span> <span class="n">stereofacade</span><span class="o">.</span><span class="n">HasTetrahedralStereo</span><span class="p">(</span><span class="n">atomid</span><span class="p">))</span>
<span class="n">tetstereo</span> <span class="o">=</span> <span class="n">stereofacade</span><span class="o">.</span><span class="n">GetTetrahedralStereo</span><span class="p">(</span><span class="n">atomid</span><span class="p">)</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">tetstereo</span><span class="o">.</span><span class="n">GetConfig</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The stereocenter is at atom Id </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">center</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is the configuration specified? </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;Yes&quot;</span> <span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">specified</span> <span class="k">else</span> <span class="s2">&quot;No&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Looking from atom Id </span><span class="si">{0}</span><span class="s2">, the atoms Ids </span><span class="si">{1}</span><span class="s2"> are arranged clockwise&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">from_or_towards</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">refs</span><span class="p">))</span>
</pre></div>
</div>
<p>Which prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Does this atom have tet stereo info? True
The stereocenter is at atom Id 1
Is the configuration specified? Yes
Looking from atom Id 0, the atoms Ids (2, 3, 4) are arranged clockwise
</pre></div>
</div>
<p>How do I know that I’m looking from atom Id 0, and that the atom Ids are arranged clockwise? From the documentation for <code class="docutils literal notranslate"><span class="pre">OBTetrahedralStereo::GetConfig</span></code>, which states that this is the default. You may be used to thinking “How are these atoms arranged looking from here?”. With GetConfig(), you are instead making the request “Give me the atoms in clockwise order looking from here”.  It follows from this that you should never need to test the value of the winding, the direction, or the from/towards atom; you provide these, and their values will be whatever you provided. For example, you could instead ask for the anticlockwise arrangement of atoms looking <em>towards</em> the atom with Id 0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">configB</span> <span class="o">=</span> <span class="n">tetstereo</span><span class="o">.</span><span class="n">GetConfig</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereo</span><span class="o">.</span><span class="n">AntiClockwise</span><span class="p">,</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereo</span><span class="o">.</span><span class="n">ViewTowards</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Looking towards atom Id </span><span class="si">{0}</span><span class="s2">, the atoms Ids </span><span class="si">{1}</span><span class="s2"> are arranged anticlockwise&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">from_or_towards</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">refs</span><span class="p">))</span>
</pre></div>
</div>
<p>Which prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Looking</span> <span class="n">towards</span> <span class="n">atom</span> <span class="n">Id</span> <span class="mi">0</span><span class="p">,</span> <span class="n">the</span> <span class="n">atoms</span> <span class="n">Ids</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="n">are</span> <span class="n">arranged</span> <span class="n">anticlockwise</span>
</pre></div>
</div>
<p>To check whether two Configs represent the same stereo configuration, use the equality operator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">config</span> <span class="o">==</span> <span class="n">configB</span>
</pre></div>
</div>
<p>It should be noted that the Config objects returned by GetConfig() are <em>copies</em> of the stereo configuration. That is, modifying them has no affect on the stereochemistry of the molecule (see the next section). As a result, it is straightforward to keep a copy of the stereo configuration, modify the molecule, and then check whether the modification has altered the stereochemistry using the equality operator of the Config.</p>
</section>
<section id="modifying-the-stereochemistry">
<h2>Modifying the stereochemistry<a class="headerlink" href="#modifying-the-stereochemistry" title="Link to this heading">#</a></h2>
<p>We discuss below the interaction between 2D and 3D structural information and how stereochemistry is perceived. For now, let’s avoid these issues by using a 0D structure and modifying its stereochemistry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">pybel</span>
<span class="n">ob</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">ob</span>

<span class="n">mol</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readstring</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="s2">&quot;C[C@@H](Cl)F&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;nonewline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}))</span>

<span class="c1"># Invert the stereo</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">OBMol</span>
<span class="n">facade</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereoFacade</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">tetstereo</span> <span class="o">=</span> <span class="n">facade</span><span class="o">.</span><span class="n">GetTetrahedralStereo</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">GetAtom</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">tetstereo</span><span class="o">.</span><span class="n">GetConfig</span><span class="p">()</span>
<span class="n">config</span><span class="o">.</span><span class="n">winding</span> <span class="o">=</span> <span class="n">ob</span><span class="o">.</span><span class="n">OBStereo</span><span class="o">.</span><span class="n">AntiClockwise</span>
<span class="n">tetstereo</span><span class="o">.</span><span class="n">SetConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;nonewline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}))</span>

<span class="n">config</span><span class="o">.</span><span class="n">specified</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">tetstereo</span><span class="o">.</span><span class="n">SetConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;smi&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;nonewline&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}))</span>
</pre></div>
</div>
<p>which prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cl</span><span class="p">)</span><span class="n">F</span>
<span class="n">C</span><span class="p">[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">Cl</span><span class="p">)</span><span class="n">F</span>
<span class="n">CC</span><span class="p">(</span><span class="n">Cl</span><span class="p">)</span><span class="n">F</span>
</pre></div>
</div>
<p>How did I know that setting the relative arrangement to anti-clockwise would invert the stereo? Again, as described above, by default GetConfig() returns the atoms in clockwise order. Another way to invert the stereo would be to swap two of the refs, or to set the direction from ‘from’ to ‘towards’.</p>
</section>
<section id="stereo-perception">
<h2>Stereo perception<a class="headerlink" href="#stereo-perception" title="Link to this heading">#</a></h2>
<p>Until now we have not mentioned where this stereo information came from; we have read a SMILES string and somehow the resulting molecule has stereo data associated with it.</p>
<p>Stereo perception is the identification of stereo centers from the molecule and its associated data, which may include 3D coordinates, stereobonds and existing stereo data. Passing an OBMol to the global function <code class="docutils literal notranslate"><span class="pre">PerceiveStereo</span></code> triggers stereo perception, and sets a flag marking stereo as perceived (<code class="docutils literal notranslate"><span class="pre">OBMol::SetChiralityPerceived(true)</span></code>). If, in the first place, stereo was already marked as perceived then stereo perception is not performed. Any operations that require stereo information should call PerceiveStereo before accessing stereo information.</p>
<p>Behind the scenes, the code for stereo perception is quite different depending on the dimensionality (<code class="docutils literal notranslate"><span class="pre">OBMol::GetDimension()</span></code>) of the molecule.</p>
<p class="rubric">3D structures</p>
<p>Perhaps the most straightforward is when the structure has 3D coordinates. In this case, a symmetry analysis identifies stereogenic centers whose stereoconfigurations are then perceived from the coordinates. Some file formats such as the MOL file allow atoms and double bonds to be marked as have unspecified stereochemistry, and this information is applied to the detected stereocenters. For the specific case of the MOL file, the flag in the atom block that marks this is ignored by default (as required by the specification) but an option (<code class="docutils literal notranslate"><span class="pre">s</span></code>) is provided to read it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ obabel -:&quot;I/C=C/C[C@@](Br)(Cl)F&quot; --gen3d -omol | obabel -imol -osmi
I/C=C/C[C@@](Br)(Cl)F
$ obabel -:&quot;IC=CCC(Br)(Cl)F&quot; --gen3d -omol | obabel -imol -osmi
IC=CC[C@@](Br)(Cl)F
$ obabel -:&quot;IC=CCC(Br)(Cl)F&quot; --gen3d -omol | obabel -imol -as -osmi
IC=CCC(Br)(Cl)F
</pre></div>
</div>
<p>As just described, the flow of information is from the 3D coordinates to Open Babel’s internal record of stereo centers, and this flow is triggered by calling stereo perception (which does nothing if the stereo is marked as already perceived). It follows from this that altering the coordinates <em>after</em> stereo perception (e.g. by reflecting through an axis, thereby inverting chirality) has no affect on the internal stereo data. If operations are performed on the molecule that require stereo is be reperceived, then <code class="docutils literal notranslate"><span class="pre">OBMol::SetChiralityPerceived(false)</span></code> should be called.</p>
<p>It should also be clear from the discussion above that changing the stereo data (e.g. using SetConfig() to invert a tetrahedral stereocenter) has no affect on the molecule’s coordinates (though it may affect downstream processing, such as the information written to a SMILES string). If this is needed, the user will have to manipulate the coordinates themselves, or generate coordinates for the whole molecule using the associated library functions (e.g. the <code class="docutils literal notranslate"><span class="pre">--gen3d</span></code> operation).</p>
<p class="rubric">2D structures</p>
<p>2D structures represent a depiction of a molecule, where stereochemistry is usually indicated by wedge or hash bonds. It is sometimes indicated by adopting particular conventions (e.g. the Fischer or Haworth projection of monosaccharides). It should be noted that Open Babel does not support any of these conventions, nor does it support the use of wedge or hash bonds for perspective drawing (e.g. where a thick bond is supported by two wedges). This may change in future, of course, but it’s worth noting that Open Babel is not the only toolkit with these limitations and so what you think you are storing in your database may not be what the ‘computer’ thinks it is.</p>
<p>Stereo centers are identified based on a symmetry analysis, and their configuration inferred either from the geometry (for cis/trans bonds) or from bonds marked as wedge/hash (tetrahedral centers). File format readers record information about which bonds were marked as wedges or hashes and this can be accessed with OBBond:IsWedge/IsHash, where the Begin atom of the bond is considered the origin of the wedge/hash. Similar to the situation with 3D perception, changing a bond from a wedge to a hash (or vice versa) has no affect on the stereo objects once stereo has been perceived, but triggering reperception will regenerate the desired stereo data.</p>
<p>It should also be noted that the file writers regenerate the wedges or hashes from the stereo data at the point of writing; in other words, the particular location of the wedge/hash (or even whether it is present) may change on writing. This was done to ensure that the written structure accurately represents Open Babel’s internal view of the molecule; passing wedges/hashes through unchanged may not represent this (consider the case where a wedge bond is attached to a tetrahedral center which cannot be a stereocenter).</p>
<p class="rubric">0D structures</p>
<p>A SMILES string is sometimes referred to as describing a 0.5D structure, as it can describe the relative arrangement of atoms around stereocenters. The SMILES reader simply reads and records this information as stereo data, and then the molecule is marked as having stereo perceived (unless the <code class="docutils literal notranslate"><span class="pre">S</span></code> option is passed - see below).</p>
<p>Being able to skip the symmetry analysis associated with stereo perception means that SMILES strings can be read quickly - a useful feature if dealing with millions of molecules. However, if you wish to identify additional stereocenters whose stereo configuration is unspecified, or if the SMILES strings come from an untrusted source and stereo may have been incorrectly specified (e.g. on a tetrahedral center with two groups the same), then you may wish to trigger perception.</p>
<p>Without any additional information, stereo cannot be perceived from a structure that has neither 2D nor 3D coordinates. Triggering stereo perception on such a structure will generate stereo data if stereogenic centers are present, but their configuration will be marked as unspecified. However, where existing stereo data is present (e.g. after reading a SMILES string), that data will be retained if the stereocenter is identified by the perception routine as a true stereocenter. This can be illustrated using the <code class="docutils literal notranslate"><span class="pre">S</span></code> option to the SMILES reader, which tells it not to mark the stereo as perceived on reading; as a result, reperception will occur if triggered by a writer yielding different results in the case of an erroneously specified stereocenter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ obabel -:&quot;F[C@@](F)(F)[C@@H](I)Br&quot; -osmi
F[C@@](F)(F)[C@@H](I)Br
$ obabel -:&quot;F[C@@](F)(F)[C@@H](I)Br&quot; -aS -osmi
FC(F)(F)[C@@H](I)Br
</pre></div>
</div>
</section>
<section id="miscellaneous-stereo-functions-in-the-api">
<h2>Miscellaneous stereo functions in the API<a class="headerlink" href="#miscellaneous-stereo-functions-in-the-api" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OBAtom::IsChiral</span></code> - this is a convenience function that checks whether there is any tetrahedral stereo data associated with a particular atom. OBStereoFacade should be used in preference to this.</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../Cheminf101/registration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chemical Registration Systems</p>
      </div>
    </a>
    <a class="right-next"
       href="../Aromaticity/Aromaticity.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Handling of aromaticity</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-stereochemistry-information">Accessing stereochemistry information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-config-object">The Config() object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-the-stereochemistry">Modifying the stereochemistry</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stereo-perception">Stereo perception</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#miscellaneous-stereo-functions-in-the-api">Miscellaneous stereo functions in the API</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/openbabel/openbabel.github.io/edit/main/source/docs/Stereochemistry/stereo.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright ©2023 The Open Babel Team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>