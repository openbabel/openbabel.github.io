<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open Babel: Substructure Searching</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open Babel
   &#160;<span id="projectnumber">3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Substructure Searching</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml">OBIsomorphismMapper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBSmartsPattern.shtml">OBSmartsPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBQueryAtom.shtml">OBQueryAtom</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBQueryBond.shtml">OBQueryBond</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBQuery.shtml">OBQuery</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga9373f6c3f788157de6f03c9403be34c4"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga9373f6c3f788157de6f03c9403be34c4">Automorphism</a></td></tr>
<tr class="separator:ga9373f6c3f788157de6f03c9403be34c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6179e6c11d4f797e8d0ef6ac5c9f25a8"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#af45ae29000944170414da618d8d5d677">OBIsomorphismMapper::Mappings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga6179e6c11d4f797e8d0ef6ac5c9f25a8">Automorphisms</a></td></tr>
<tr class="separator:ga6179e6c11d4f797e8d0ef6ac5c9f25a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4edd651fb377c60f3b7ac2f48b7f5e57"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga4edd651fb377c60f3b7ac2f48b7f5e57">MapsTo</a> (const <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &amp;map, unsigned int queryIndex, unsigned int &amp;queriedIndex)</td></tr>
<tr class="separator:ga4edd651fb377c60f3b7ac2f48b7f5e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga16841a730cf92c8e51a804ad8d746307"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga16841a730cf92c8e51a804ad8d746307">FindAutomorphisms</a> (<a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *mol, std::vector&lt; <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &gt; &amp;aut, const std::vector&lt; unsigned int &gt; &amp;symmetry_classes, const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;mask=<a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>(), std::size_t maxMemory=3000000)</td></tr>
<tr class="separator:ga16841a730cf92c8e51a804ad8d746307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7753422526ba34488edf393803aabad7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga7753422526ba34488edf393803aabad7">FindAutomorphisms</a> (<a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *mol, std::vector&lt; <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &gt; &amp;aut, const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;mask=<a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>(), std::size_t maxMemory=3000000)</td></tr>
<tr class="separator:ga7753422526ba34488edf393803aabad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6a2b6b84fc5e4432152e29001877c59b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga6a2b6b84fc5e4432152e29001877c59b">FindAutomorphisms</a> (<a class="el" href="classOpenBabel_1_1OBIsomorphismMapper_1_1Functor.shtml">OBIsomorphismMapper::Functor</a> &amp;functor, <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *mol, const std::vector&lt; unsigned int &gt; &amp;symmetry_classes, const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;mask=<a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>())</td></tr>
<tr class="separator:ga6a2b6b84fc5e4432152e29001877c59b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9307ec0c55a4d2b7ee933b53a3a84ce5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenBabel_1_1OBQuery.shtml">OBQuery</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga9307ec0c55a4d2b7ee933b53a3a84ce5">CompileMoleculeQuery</a> (<a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *mol, const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;mask=<a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>())</td></tr>
<tr class="separator:ga9307ec0c55a4d2b7ee933b53a3a84ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87fabf6ed3625406fe5d117b134b5f16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenBabel_1_1OBQuery.shtml">OBQuery</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__substructure.shtml#ga87fabf6ed3625406fe5d117b134b5f16">CompileSmilesQuery</a> (const std::string &amp;smiles, const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;mask=<a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>())</td></tr>
<tr class="separator:ga87fabf6ed3625406fe5d117b134b5f16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>


<h3><a id="substructure"></a>Substructure Search</h3><div class="textblock"><dl class="section since"><dt>Since</dt><dd>version 2.3</dd></dl>
<p>Substructure searching is finding a mapping for a query to a target molecule. Such a mapping is also known as a graph isomorphism. A graph isomorphism maps the vertexes (i.e. atoms) from the query to vertexes in the molecule such that two vertexes adjacent in the query are also adjacent in the target molecule. In other words, no bonds are broken and no new bonds are formed.<h1><a class="anchor" id="smarts"></a>
SMARTS Substructure Search</h1>
<p>Smarts is an extension of smiles to create powerful queries. Smarts substructure search has been available in <a class="el" href="namespaceOpenBabel.shtml" title="Global namespace for all Open Babel code. ">OpenBabel</a> for many years. It is also used for many of <a class="el" href="namespaceOpenBabel.shtml" title="Global namespace for all Open Babel code. ">OpenBabel</a>'s algorithms. Although smarts is only a syntax for queries, the implementation has it's own matching algorithm. For many purposes smarts are the easiest way to do substructure searches. See the <a class="el" href="classOpenBabel_1_1OBSmartsPattern.shtml" title="SMARTS (SMiles ARbitrary Target Specification) substructure searching. ">OBSmartsPattern</a> documentation for details on how to use smarts.</p>
<h1><a class="anchor" id="query"></a>
Queries</h1>
<p>Since <a class="el" href="namespaceOpenBabel.shtml" title="Global namespace for all Open Babel code. ">OpenBabel</a> version 2.3, there are some classes for representing generic queries. The <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a>, <a class="el" href="classOpenBabel_1_1OBQueryAtom.shtml" title="Atom in an OBQuery. ">OBQueryAtom</a> and <a class="el" href="classOpenBabel_1_1OBQueryBond.shtml" title="Bond in an OBQuery. ">OBQueryBond</a> class define interfaces that can be reimplemented to get custom behavior. The classes also contain some methods to access topological information which are used by the mapping algorithms. The default implementations allow very simple exact substructure searches to be performed but subclassing allows very advanced queries to be used (e.g. smarts).</p>
<p>While it is possible to construct these queries manually, "compilers" are provided to convert a query representation to a <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object. Currently, only two exact substructure search compilers exist. The first is CompileMoleculeQuery which converts an <a class="el" href="classOpenBabel_1_1OBMol.shtml" title="Molecule Class. ">OBMol</a> object to an <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object. The second is CompileSmilesQuery and converts a smiles string to an <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="query_8h.shtml">openbabel/query.h</a>&gt;</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceOpenBabel.shtml">OpenBabel</a>;</div><div class="line"></div><div class="line"><a class="code" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *mol = <span class="keyword">new</span> <a class="code" href="classOpenBabel_1_1OBMol.shtml">OBMol</a>;</div><div class="line"></div><div class="line"><span class="comment">// ... read molecule ...</span></div><div class="line"></div><div class="line"><a class="code" href="classOpenBabel_1_1OBQuery.shtml">OBQuery</a> *query;</div><div class="line">query = <a class="code" href="group__substructure.shtml#ga9307ec0c55a4d2b7ee933b53a3a84ce5">CompileMoleculeQuery</a>(mol);</div><div class="line">query = <a class="code" href="group__substructure.shtml#ga87fabf6ed3625406fe5d117b134b5f16">CompileSmilesQuery</a>(<span class="stringliteral">&quot;c1ccccc1CC(=O)O&quot;</span>);</div></div><!-- fragment --><h1><a class="anchor" id="mapping"></a>
Mapping Isomorphisms</h1>
<p>The <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml" title="Abstract class defining interface for isomorphism (i.e. substructure) searches. ">OBIsomorphismMapper</a> class defined an interface for mapping queries to target molecules. Multiple implementations can be added but they all do the same. The MapFirst, MapUnique and MapAll methods are used for gettings the map(s).</p>
<h2><a class="anchor" id="MapFirst"></a>
MapFirst</h2>
<p>This method returns the first map found. The main reason for getting only one map is improved performance since it is considerably faster than MapUnique and MapAll. However, depending on the use case a single map is all that is needed. For example, to check if a molecule in a database contains a phenyl ring, a single mapping is enough.</p>
<h2><a class="anchor" id="MapUnique"></a>
MapUnique</h2>
<p>MapUnique returns all unique maps. A map is considered unique if there is no other map covering exactly the same atoms in the target molecule. For example, when a phenyl query is performed on a molecule with 2 phenyl rings, MapUnique will return 2 maps. These 2 maps are selected from the 24 found non-duplicate maps (6 atoms to start from * 2 directions (CW/CCW) * 2 rings).</p>
<h2><a class="anchor" id="MapAll"></a>
MapAll</h2>
<p>MapAll returns all non-duplicate maps. For example, when a phenyl query is performed on a molecule with 2 phenyl rings, MapAll will return 24 maps (6 atoms to start from * 2 directions (CW/CCW) * 2 rings).</p>
<h2><a class="anchor" id="MapGeneric"></a>
MapGeneric</h2>
<p>MapGeneric takes a functor object and calls the functor to handle found isomorphisms. This allows for custom mapping results to be obtained by filtering or avoid storing all results. To implement a custom functor, a simple class that inherits <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper_1_1Functor.shtml" title="Functor base class to be used in combination with MapGeneric. ">OBIsomorphismMapper::Functor</a> and implements the required operator().</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="isomorphism_8h.shtml">openbabel/isomorphism.h</a>&gt;</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceOpenBabel.shtml">OpenBabel</a>;</div><div class="line"></div><div class="line"><span class="keyword">class </span>MyCustomFunctor : <span class="keyword">public</span> <a class="code" href="classOpenBabel_1_1OBIsomorphismMapper_1_1Functor.shtml">OBIsomorphismMapper::Functor</a></div><div class="line">{</div><div class="line">  <span class="keyword">private</span>:</div><div class="line">    <span class="comment">// store all mappings in m_data</span></div><div class="line">    std::vector&lt;OBIsomorphismMapper::Mapping&gt; &amp;m_data;</div><div class="line">  <span class="keyword">public</span>:</div><div class="line">    MyCustomFunctor(std::vector&lt;OBIsomorphismMapper::Mapping&gt; &amp;data) : m_data(data) {}</div><div class="line">    <span class="keywordtype">bool</span> operator()(<a class="code" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &amp;map)</div><div class="line">    {</div><div class="line">      <span class="comment">// code to handle found isomorphism...</span></div><div class="line">      <span class="comment">// examples: - store the mapping</span></div><div class="line">      <span class="comment">//           - filter mappings</span></div><div class="line">      <span class="comment">//           - use the found map in some way</span></div><div class="line"></div><div class="line">      m_data.push_back(map);</div><div class="line"></div><div class="line">      <span class="comment">// continue mapping</span></div><div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="automorphisms"></a>
Automorphisms</h1>
<p>The automorphisms of a graph or molecule are a group of isomorphism mappings of the molecule onto itself (i.e. the query and target are the same). The automorphisms make it easy to take symmetry into account. See FindAutomorphisms for detials. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="ga9373f6c3f788157de6f03c9403be34c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9373f6c3f788157de6f03c9403be34c4">&#9670;&nbsp;</a></span>Automorphism</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> <a class="el" href="group__substructure.shtml#ga9373f6c3f788157de6f03c9403be34c4">Automorphism</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A single automorphic permutation. </p>
<dl class="section since"><dt>Since</dt><dd>2.3 </dd></dl>

</div>
</div>
<a id="ga6179e6c11d4f797e8d0ef6ac5c9f25a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6179e6c11d4f797e8d0ef6ac5c9f25a8">&#9670;&nbsp;</a></span>Automorphisms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#af45ae29000944170414da618d8d5d677">OBIsomorphismMapper::Mappings</a> <a class="el" href="group__substructure.shtml#ga6179e6c11d4f797e8d0ef6ac5c9f25a8">Automorphisms</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A group of automorphic permutations. </p>
<dl class="section since"><dt>Since</dt><dd>2.3 </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga4edd651fb377c60f3b7ac2f48b7f5e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4edd651fb377c60f3b7ac2f48b7f5e57">&#9670;&nbsp;</a></span>MapsTo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool OpenBabel::MapsTo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &amp;&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>queryIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>queriedIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ga16841a730cf92c8e51a804ad8d746307"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga16841a730cf92c8e51a804ad8d746307">&#9670;&nbsp;</a></span>FindAutomorphisms() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OpenBabel::FindAutomorphisms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>aut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>symmetry_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;&#160;</td>
          <td class="paramname"><em>mask</em> = <code><a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>maxMemory</em> = <code>3000000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the automorphisms of a molecule by using an <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml" title="Abstract class defining interface for isomorphism (i.e. substructure) searches. ">OBIsomorphismMapper</a>. This function is a wrapper for FindAutomorphisms with a functor to store all automorphisms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mol</td><td>The molecule for which to find the automorphisms. </td></tr>
    <tr><td class="paramname">aut</td><td>The result will be stored here. </td></tr>
    <tr><td class="paramname">symmetry_classes</td><td>The graph invariants to use. See <a class="el" href="classOpenBabel_1_1OBGraphSym.shtml" title="Handle and perceive graph symmtery for canonical numbering . ">OBGraphSym</a> or use the FindAutomorphisms function that computes these for you below. </td></tr>
    <tr><td class="paramname">mask</td><td>A bit vector specifying which atoms to consider. An empty mask will consider all atoms. The bits are indexed from 1 (i.e. <a class="el" href="classOpenBabel_1_1OBAtom.shtml#a44b77545e83209582e42f375c8f40474">OBAtom::GetIdx()</a>). </td></tr>
    <tr><td class="paramname">maxMemory</td><td>Maximum memory limit for <code>aut</code>. The number of automorphisms for certain graphs can be large. The default is 300MB, consider using a functor to process automorphisms when they are found.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>version 2.3 </dd></dl>

<p class="reference">Referenced by <a class="el" href="namespaceOpenBabel.shtml#a6239f809ba8a88712a94f2a6bb90a485">OpenBabel::FindAutomorphisms()</a>, and <a class="el" href="classOpenBabel_1_1OBAlign.shtml#ac56e2c2ffd9fdf7448b3bda78cdc9549">OBAlign::SetRefMol()</a>.</p>

</div>
</div>
<a id="ga7753422526ba34488edf393803aabad7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7753422526ba34488edf393803aabad7">&#9670;&nbsp;</a></span>FindAutomorphisms() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OpenBabel::FindAutomorphisms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml#a97df663c0fc8a3ba6e9113802cac5c82">OBIsomorphismMapper::Mapping</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>aut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;&#160;</td>
          <td class="paramname"><em>mask</em> = <code><a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>maxMemory</em> = <code>3000000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the automorphisms of a molecule by using an <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml" title="Abstract class defining interface for isomorphism (i.e. substructure) searches. ">OBIsomorphismMapper</a>. This function will first find the graph invariants (i.e. symmetry_classes) using the mask. This function is a wrapper for FindAutomorphisms with a functor to store all automorphisms.</p>
<dl class="section since"><dt>Since</dt><dd>version 2.3 </dd></dl>

</div>
</div>
<a id="ga6a2b6b84fc5e4432152e29001877c59b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6a2b6b84fc5e4432152e29001877c59b">&#9670;&nbsp;</a></span>FindAutomorphisms() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FindAutomorphisms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOpenBabel_1_1OBIsomorphismMapper_1_1Functor.shtml">OBIsomorphismMapper::Functor</a> &amp;&#160;</td>
          <td class="paramname"><em>functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>symmetry_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;&#160;</td>
          <td class="paramname"><em>mask</em> = <code><a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find the automorphisms of a molecule by using an <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper.shtml" title="Abstract class defining interface for isomorphism (i.e. substructure) searches. ">OBIsomorphismMapper</a>. This is the main implementation for finding automorphisms and uses an <a class="el" href="classOpenBabel_1_1OBIsomorphismMapper_1_1Functor.shtml" title="Functor base class to be used in combination with MapGeneric. ">OBIsomorphismMapper::Functor</a> to process found isomorphisms. Wrapper functions are provided to find and store all automorphisms but the number of automorphisms can be large for certain graphs making it not feasible to store all automorphisms in memory (RAM).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__substructure.shtml#MapGeneric">MapGeneric</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>version 2.3 </dd></dl>

</div>
</div>
<a id="ga9307ec0c55a4d2b7ee933b53a3a84ce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9307ec0c55a4d2b7ee933b53a3a84ce5">&#9670;&nbsp;</a></span>CompileMoleculeQuery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBQuery.shtml">OBQuery</a> * CompileMoleculeQuery </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *&#160;</td>
          <td class="paramname"><em>mol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;&#160;</td>
          <td class="paramname"><em>mask</em> = <code><a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object from an <a class="el" href="classOpenBabel_1_1OBMol.shtml" title="Molecule Class. ">OBMol</a> object. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mol</td><td>The query molecule. </td></tr>
    <tr><td class="paramname">mask</td><td>The mask specifying the atoms to use. Indexed from 1 (i.e. <a class="el" href="classOpenBabel_1_1OBAtom.shtml#a44b77545e83209582e42f375c8f40474">OBAtom::GetIdx()</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to an <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object for the smiles string. This pointer should be deleted. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>version 2.3 </dd></dl>

<p class="reference">Referenced by <a class="el" href="group__substructure.shtml#ga87fabf6ed3625406fe5d117b134b5f16">OpenBabel::CompileSmilesQuery()</a>.</p>

</div>
</div>
<a id="ga87fabf6ed3625406fe5d117b134b5f16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga87fabf6ed3625406fe5d117b134b5f16">&#9670;&nbsp;</a></span>CompileSmilesQuery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBQuery.shtml">OBQuery</a> * CompileSmilesQuery </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>smiles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a> &amp;&#160;</td>
          <td class="paramname"><em>mask</em> = <code><a class="el" href="classOpenBabel_1_1OBBitVec.shtml">OBBitVec</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object from a smiles string. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">smiles</td><td>The query smiles string. </td></tr>
    <tr><td class="paramname">mask</td><td>The mask specifying the atoms to use. Indexed from 1 (i.e. <a class="el" href="classOpenBabel_1_1OBAtom.shtml#a44b77545e83209582e42f375c8f40474">OBAtom::GetIdx()</a>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to an <a class="el" href="classOpenBabel_1_1OBQuery.shtml" title="A substructure query. ">OBQuery</a> object for the smiles string. This pointer should be deleted. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>version 2.3 </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 15 2019 21:28:04 for Open Babel by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
