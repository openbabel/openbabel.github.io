<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open Babel: OBAlign Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open Babel
   &#160;<span id="projectnumber">3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceOpenBabel.shtml">OpenBabel</a></li><li class="navelem"><a class="el" href="classOpenBabel_1_1OBAlign.shtml">OBAlign</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="classOpenBabel_1_1OBAlign-members.shtml">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">OBAlign Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="align_8h_source.shtml">openbabel/math/align.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Constructors</div></td></tr>
<tr class="memitem:a2bc7af7892ce336cbeb8a6295823a150"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a2bc7af7892ce336cbeb8a6295823a150">OBAlign</a> (bool includeH=false, bool symmetry=true)</td></tr>
<tr class="separator:a2bc7af7892ce336cbeb8a6295823a150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50daf56049eaa97c3159bceca10d5886"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a50daf56049eaa97c3159bceca10d5886">OBAlign</a> (const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;refmol, const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;targetmol, bool includeH=false, bool symmetry=true)</td></tr>
<tr class="separator:a50daf56049eaa97c3159bceca10d5886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3917e49977b8b9fb66637d6d63e39e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#ac3917e49977b8b9fb66637d6d63e39e0">OBAlign</a> (const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;ref, const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;target)</td></tr>
<tr class="separator:ac3917e49977b8b9fb66637d6d63e39e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Partial Setup</div></td></tr>
<tr class="memitem:a84ae444b6d42eedcf7865c498348df01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a84ae444b6d42eedcf7865c498348df01">SetRef</a> (const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;ref)</td></tr>
<tr class="separator:a84ae444b6d42eedcf7865c498348df01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6627870af9d18c1f4e26e9aa95de80a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a6627870af9d18c1f4e26e9aa95de80a9">SetTarget</a> (const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;target)</td></tr>
<tr class="separator:a6627870af9d18c1f4e26e9aa95de80a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac56e2c2ffd9fdf7448b3bda78cdc9549"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#ac56e2c2ffd9fdf7448b3bda78cdc9549">SetRefMol</a> (const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;refmol)</td></tr>
<tr class="separator:ac56e2c2ffd9fdf7448b3bda78cdc9549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a325b0a2af5bbc3511c6f536e686e21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a2a325b0a2af5bbc3511c6f536e686e21">SetTargetMol</a> (const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;targetmol)</td></tr>
<tr class="separator:a2a325b0a2af5bbc3511c6f536e686e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Access the result of the alignment</div></td></tr>
<tr class="memitem:a060c746a125272a535ec8f6b59f5338a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a060c746a125272a535ec8f6b59f5338a">GetRMSD</a> ()</td></tr>
<tr class="separator:a060c746a125272a535ec8f6b59f5338a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e6707da019dfa88df1e8c1aeeb6f67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classOpenBabel_1_1matrix3x3.shtml">matrix3x3</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a53e6707da019dfa88df1e8c1aeeb6f67">GetRotMatrix</a> ()</td></tr>
<tr class="separator:a53e6707da019dfa88df1e8c1aeeb6f67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a9ca08185bebf3307c4a1acd31e58c3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a6a9ca08185bebf3307c4a1acd31e58c3">GetAlignment</a> ()</td></tr>
<tr class="separator:a6a9ca08185bebf3307c4a1acd31e58c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3748ab33ffd81acda5060963bdae971a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a3748ab33ffd81acda5060963bdae971a">UpdateCoords</a> (<a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *target)</td></tr>
<tr class="separator:a3748ab33ffd81acda5060963bdae971a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Execute the alignment</h2></td></tr>
<tr class="memitem:a27960b3896c0e8f9a95a8bded32ae6e9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a27960b3896c0e8f9a95a8bded32ae6e9">AlignMethod</a> { <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a27960b3896c0e8f9a95a8bded32ae6e9a96e97fe5991a1e03950d7431b69bef13">Kabsch</a> = 0, 
<a class="el" href="classOpenBabel_1_1OBAlign.shtml#a27960b3896c0e8f9a95a8bded32ae6e9adb7ed1765ff8074e17252627f2b4ec6e">QCP</a> = 1
 }</td></tr>
<tr class="separator:a27960b3896c0e8f9a95a8bded32ae6e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946a73d3de978fd930793711f23e00b3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a946a73d3de978fd930793711f23e00b3">Align</a> ()</td></tr>
<tr class="separator:a946a73d3de978fd930793711f23e00b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56090a11eba44b89342659f4199d6a29"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBAlign.shtml#a56090a11eba44b89342659f4199d6a29">SetMethod</a> (enum <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a27960b3896c0e8f9a95a8bded32ae6e9">AlignMethod</a> method)</td></tr>
<tr class="separator:a56090a11eba44b89342659f4199d6a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Perform a least-squares alignment of two molecules or two vectors of <a class="el" href="classOpenBabel_1_1vector3.shtml" title="Represents a vector in 3-dimensional real space. ">vector3</a> objects. </p>
<p>This class may be used to perform a least-squares alignment of two <a class="el" href="classOpenBabel_1_1OBMol.shtml" title="Molecule Class. ">OBMol</a> objects or two vector&lt;vector3&gt; objects. The Kabsch algorithm is used for the alignment.</p>
<p>During the alignment, the Target is aligned to the Reference. Note that mutiple alignments to the same Reference will be much faster than multiple alignments to the same Target. When carrying out multiple alignments, a single <a class="el" href="classOpenBabel_1_1OBAlign.shtml" title="Perform a least-squares alignment of two molecules or two vectors of vector3 objects. ">OBAlign</a> instance should be reused by calling <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a6627870af9d18c1f4e26e9aa95de80a9">SetTarget()</a> or <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a2a325b0a2af5bbc3511c6f536e686e21">SetTargetMol()</a> for each additional Target and then calling <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a946a73d3de978fd930793711f23e00b3">Align()</a>.</p>
<p>When aligning molecules, the atoms of the two molecules must be in the same order for the results to be sensible. By default, hydrogens are not included in the least-squares fitting procedure (set <code>includeH</code> to true if you wish to include them) and so the resulting RMSD is the heavy-atom RMSD (which is usually what you want).</p>
<p>By default, symmetry is taken into account when comparing molecules. For example, if a benzene is flipped by 180 degrees along one of its 2-fold symmetry axes, it will only have an RMSD of 0 (with respect to its original orientation) if symmetry is enabled. To turn off handling of symmetry set <code>symmetry</code> to false (this will speed up the alignment).</p>
<p>Note that neither the Target nor the Reference are modified by the algorithm. As a result, to update a TargetMol with the new coordinates from the alignment, you need to use <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a3748ab33ffd81acda5060963bdae971a">UpdateCoords()</a>.</p>
<dl class="section since"><dt>Since</dt><dd>version 2.3 </dd></dl>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a27960b3896c0e8f9a95a8bded32ae6e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27960b3896c0e8f9a95a8bded32ae6e9">&#9670;&nbsp;</a></span>AlignMethod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a27960b3896c0e8f9a95a8bded32ae6e9">AlignMethod</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a27960b3896c0e8f9a95a8bded32ae6e9a96e97fe5991a1e03950d7431b69bef13"></a>Kabsch&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a27960b3896c0e8f9a95a8bded32ae6e9adb7ed1765ff8074e17252627f2b4ec6e"></a>QCP&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2bc7af7892ce336cbeb8a6295823a150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bc7af7892ce336cbeb8a6295823a150">&#9670;&nbsp;</a></span>OBAlign() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBAlign.shtml">OBAlign</a> </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>includeH</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>symmetry</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If this constructor is used, the Target and Reference must be set using SetRef/SetRefMol and SetTarget/SetTargetMol before running the alignment. </p>

</div>
</div>
<a id="a50daf56049eaa97c3159bceca10d5886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50daf56049eaa97c3159bceca10d5886">&#9670;&nbsp;</a></span>OBAlign() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBAlign.shtml">OBAlign</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;&#160;</td>
          <td class="paramname"><em>refmol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;&#160;</td>
          <td class="paramname"><em>targetmol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>includeH</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>symmetry</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align two molecules. </p>

</div>
</div>
<a id="ac3917e49977b8b9fb66637d6d63e39e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3917e49977b8b9fb66637d6d63e39e0">&#9670;&nbsp;</a></span>OBAlign() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1OBAlign.shtml">OBAlign</a> </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align two vectors of <a class="el" href="classOpenBabel_1_1vector3.shtml" title="Represents a vector in 3-dimensional real space. ">vector3</a> objects. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a84ae444b6d42eedcf7865c498348df01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84ae444b6d42eedcf7865c498348df01">&#9670;&nbsp;</a></span>SetRef()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetRef </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ref</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the Reference (to which the Target will be aligned) in terms of a vector of <a class="el" href="classOpenBabel_1_1vector3.shtml" title="Represents a vector in 3-dimensional real space. ">vector3</a> objects. Note that it is faster to perform multiple alignments to the same Reference, rather than multiple alignments to the same Target. </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBAlign.shtml#ac3917e49977b8b9fb66637d6d63e39e0">OBAlign::OBAlign()</a>, <a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBRMSDConformerScore::Score()</a>, <a class="el" href="classOpenBabel_1_1OBMinimizingRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBMinimizingRMSDConformerScore::Score()</a>, and <a class="el" href="classOpenBabel_1_1OBAlign.shtml#ac56e2c2ffd9fdf7448b3bda78cdc9549">OBAlign::SetRefMol()</a>.</p>

</div>
</div>
<a id="a6627870af9d18c1f4e26e9aa95de80a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6627870af9d18c1f4e26e9aa95de80a9">&#9670;&nbsp;</a></span>SetTarget()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetTarget </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the Target (which will be aligned to the Reference) in terms of a vector of <a class="el" href="classOpenBabel_1_1vector3.shtml" title="Represents a vector in 3-dimensional real space. ">vector3</a> objects. </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBAlign.shtml#ac3917e49977b8b9fb66637d6d63e39e0">OBAlign::OBAlign()</a>, <a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBRMSDConformerScore::Score()</a>, <a class="el" href="classOpenBabel_1_1OBMinimizingRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBMinimizingRMSDConformerScore::Score()</a>, and <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a2a325b0a2af5bbc3511c6f536e686e21">OBAlign::SetTargetMol()</a>.</p>

</div>
</div>
<a id="ac56e2c2ffd9fdf7448b3bda78cdc9549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56e2c2ffd9fdf7448b3bda78cdc9549">&#9670;&nbsp;</a></span>SetRefMol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetRefMol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;&#160;</td>
          <td class="paramname"><em>refmol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the Reference Molecule (to which the Target Molecule must be aligned). Note that is faster to perform multiple alignments to the same Reference Molecule, rather than multple alignments to the same Target Molecule. </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a50daf56049eaa97c3159bceca10d5886">OBAlign::OBAlign()</a>.</p>

</div>
</div>
<a id="a2a325b0a2af5bbc3511c6f536e686e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a325b0a2af5bbc3511c6f536e686e21">&#9670;&nbsp;</a></span>SetTargetMol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetTargetMol </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> &amp;&#160;</td>
          <td class="paramname"><em>targetmol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the Target Molecule (which will be aligned to the Reference Molecule). </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a50daf56049eaa97c3159bceca10d5886">OBAlign::OBAlign()</a>.</p>

</div>
</div>
<a id="a946a73d3de978fd930793711f23e00b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946a73d3de978fd930793711f23e00b3">&#9670;&nbsp;</a></span>Align()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Align </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Align the Target to the Reference using a least-squares alignment. </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBRMSDConformerScore::Score()</a>, and <a class="el" href="classOpenBabel_1_1OBMinimizingRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBMinimizingRMSDConformerScore::Score()</a>.</p>

</div>
</div>
<a id="a56090a11eba44b89342659f4199d6a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56090a11eba44b89342659f4199d6a29">&#9670;&nbsp;</a></span>SetMethod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetMethod </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a27960b3896c0e8f9a95a8bded32ae6e9">AlignMethod</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a060c746a125272a535ec8f6b59f5338a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a060c746a125272a535ec8f6b59f5338a">&#9670;&nbsp;</a></span>GetRMSD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double GetRMSD </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the root mean squared deviation of the target from the reference. This function should only be called after running the alignment (using <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a946a73d3de978fd930793711f23e00b3">Align()</a>). </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBRMSDConformerScore::Score()</a>, and <a class="el" href="classOpenBabel_1_1OBMinimizingRMSDConformerScore.shtml#af1228b5c549dc40002a6c2919b5c9cef">OBMinimizingRMSDConformerScore::Score()</a>.</p>

</div>
</div>
<a id="a53e6707da019dfa88df1e8c1aeeb6f67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53e6707da019dfa88df1e8c1aeeb6f67">&#9670;&nbsp;</a></span>GetRotMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOpenBabel_1_1matrix3x3.shtml">matrix3x3</a> GetRotMatrix </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the rotation matrix associated with the least squares alignment. This function should only be called after running the alignment (using <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a946a73d3de978fd930793711f23e00b3">Align()</a>).</p>
<p>The following example shows how to use the rotation matrix to rotate all of the atoms in a molecule. </p><div class="fragment"><div class="line">matrix3x3 rotmatrix = align.GetRotMatrix();</div><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt;= mol.NumAtoms(); ++i) {</div><div class="line">   vector3 tmpvec = mol.GetAtom(i)-&gt;GetVector();</div><div class="line">   tmpvec *= rotmatrix; <span class="comment">//apply the rotation</span></div><div class="line">   mol.GetAtom(i)-&gt;SetVector(tmpvec);</div><div class="line">}</div></div><!-- fragment --><p> Note that if you wish to use the rotation matrix to find the aligned coordinates (that is, the same coordinates returned by <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a6a9ca08185bebf3307c4a1acd31e58c3">GetAlignment()</a>), you should first translate the set of coordinates to the origin by subtracting the centroid, then apply the rotation, and finally add the centroid of the reference coordinates. </p>

</div>
</div>
<a id="a6a9ca08185bebf3307c4a1acd31e58c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a9ca08185bebf3307c4a1acd31e58c3">&#9670;&nbsp;</a></span>GetAlignment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; <a class="el" href="classOpenBabel_1_1vector3.shtml">vector3</a> &gt; GetAlignment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the actual alignment of the Target to the Reference in terms of a vector of <a class="el" href="classOpenBabel_1_1vector3.shtml" title="Represents a vector in 3-dimensional real space. ">vector3</a> objects. If you want an <a class="el" href="classOpenBabel_1_1OBMol.shtml" title="Molecule Class. ">OBMol</a> with the aligned coordinates, you should use <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a3748ab33ffd81acda5060963bdae971a">UpdateCoords()</a> instead. This function should only be called after running the alignment (using <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a946a73d3de978fd930793711f23e00b3">Align()</a>). </p>

<p class="reference">Referenced by <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a3748ab33ffd81acda5060963bdae971a">OBAlign::UpdateCoords()</a>.</p>

</div>
</div>
<a id="a3748ab33ffd81acda5060963bdae971a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3748ab33ffd81acda5060963bdae971a">&#9670;&nbsp;</a></span>UpdateCoords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UpdateCoords </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOpenBabel_1_1OBMol.shtml">OBMol</a> *&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the coordinates of an <a class="el" href="classOpenBabel_1_1OBMol.shtml" title="Molecule Class. ">OBMol</a> to those from the alignment. This function should only be called after running the alignment (using <a class="el" href="classOpenBabel_1_1OBAlign.shtml#a946a73d3de978fd930793711f23e00b3">Align()</a>). </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="align_8h_source.shtml">align.h</a></li>
<li><a class="el" href="align_8cpp.shtml">align.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 15 2019 21:28:05 for Open Babel by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
