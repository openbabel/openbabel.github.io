<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open Babel: Conformer Searching</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open Babel
   &#160;<span id="projectnumber">3.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Conformer Searching</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBConformerFilter.shtml">OBConformerFilter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBConformerFilters.shtml">OBConformerFilters</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBStericConformerFilter.shtml">OBStericConformerFilter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBConformerScore.shtml">OBConformerScore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml">OBRMSDConformerScore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBEnergyConformerScore.shtml">OBEnergyConformerScore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBMinimizingEnergyConformerScore.shtml">OBMinimizingEnergyConformerScore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBMinimizingRMSDConformerScore.shtml">OBMinimizingRMSDConformerScore</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOpenBabel_1_1OBConformerSearch.shtml">OBConformerSearch</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="anchor" id="introduction"></a>
Introduction</h1>
<p>All conformer searching methods in <a class="el" href="namespaceOpenBabel.shtml" title="Global namespace for all Open Babel code. ">OpenBabel</a> are based on the concept of rotor keys. A rotor key is simply an array of values specifying the rotations around rotatable bonds. The number of possible values for a rotatable bond depends on the bond type. The classes implementing the rotor key concept are <a class="el" href="classOpenBabel_1_1OBRotor.shtml" title="A single rotatable OBBond as part of rotamer searching. ">OBRotor</a>, <a class="el" href="classOpenBabel_1_1OBRotorList.shtml" title="Given an OBMol, set up a list of possibly rotatable torsions,. ">OBRotorList</a> and OBRotamer.</p>
<p>Previous <a class="el" href="namespaceOpenBabel.shtml" title="Global namespace for all Open Babel code. ">OpenBabel</a> releases contained only methods for finding stable (low energy) conformers by using the force fields. The 2.3 release introduces a new flexible class (<a class="el" href="classOpenBabel_1_1OBConformerSearch.shtml" title="Conformer searching using genetic algorithm. See Conformer Searching. ">OBConformerSearch</a>) implementing a genetic algorithm. The scoring or ranking of conformers is done by a seperate class derived from the abstract <a class="el" href="classOpenBabel_1_1OBConformerScore.shtml" title="Interface used by OBConformerSearch for scoring conformers. ">OBConformerScore</a> class. Reimplementing this class allows for all sorts of scoring functions (e.g. RMSD, torson, energy, ... based).</p>
<h1><a class="anchor" id="stable"></a>
Finding stable conformers</h1>
<h2><a class="anchor" id="systematic"></a>
Systematic rotor search</h2>
<p>This is the simplest of all conformer searching methods and only suitable when there are only a few rotatable bonds. Since the number of conformers grows exponentially with the number of bonds, enumerating all conformers for reasonably sized molecules quickly results in unacceptable performance. A systematic rotor search can be done with the <a class="el" href="classOpenBabel_1_1OBForceField.shtml#aad044993a4dab58de3b5f3ac6c5815fe">OBForceField::SystematicRotorSearch</a> method.</p>
<h2><a class="anchor" id="random"></a>
Random rotor search</h2>
<p>The random rotor search generates random rotor keys and evaluates the energy. The lowest energy conformer is kept. All rotor keys are random and no attempt is made to improve good scoring keys. In most cases the weighted rotor search is a better choice. A random rotor search can be performed with the <a class="el" href="classOpenBabel_1_1OBForceField.shtml#ad9a76622767b74aadf67c2c618e5ba04">OBForceField::RandomRotorSearch</a> method.</p>
<h2><a class="anchor" id="weighted"></a>
Weighted rotor search</h2>
<p>The weighted rotor search uses the score (energy) from a generated and tries to optimize good scoring keys. This allows the global minimum energy conformer to be identified much faster compared to the random rotor search. However, finding the global minimum can be time consuming for large molecules and there is no guarantee that the found minimum is the global minimum. A weighted rotor search is performed with the <a class="el" href="classOpenBabel_1_1OBForceField.shtml#a308e084198342c54de6f1fb695f23a6d">OBForceField::WeightedRotorSearch</a> method.</p>
<h2><a class="anchor" id="genetic"></a>
Genetic algorithm</h2>
<p>The <a class="el" href="classOpenBabel_1_1OBConformerSearch.shtml" title="Conformer searching using genetic algorithm. See Conformer Searching. ">OBConformerSearch</a> class introduced in <a class="el" href="namespaceOpenBabel.shtml" title="Global namespace for all Open Babel code. ">OpenBabel</a> 2.3 implements a genetic algorithm for finding conformers. The class is configurable and with the right scoring function (<a class="el" href="classOpenBabel_1_1OBEnergyConformerScore.shtml" title="A lowest energy conformer scoring class. ">OBEnergyConformerScore</a>), stable conformers can be found. Read the <a class="el" href="classOpenBabel_1_1OBConformerSearch.shtml" title="Conformer searching using genetic algorithm. See Conformer Searching. ">OBConformerSearch</a> section for more details on how the genetic algorithm works.</p>
<h1><a class="anchor" id="diverse"></a>
Finding a diverse set of conformers</h1>
<p>A divers set of conformers can be generated using the <a class="el" href="classOpenBabel_1_1OBConformerSearch.shtml" title="Conformer searching using genetic algorithm. See Conformer Searching. ">OBConformerSearch</a> class with a scoring function like <a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml" title="A RMSD conformer scoring class. ">OBRMSDConformerScore</a>. A diverse set of conformers is often useful when screening bioactive molecules since the interaction with the target can stabilize a higher conformational energy. See the next section for details.</p>
<h1><a class="anchor" id="OBConformerSearch"></a>
OBConformerSearch</h1>
<p>The genetic algorithm starts by generating the initial population of rotor keys. The initial population contains up to numConformers, duplicate keys are ignored. <a class="el" href="classOpenBabel_1_1OBConformerFilter.shtml" title="Interface used by OBConformerSearch for filtering conformers. ">OBConformerFilter</a> objects are used to filter conformers before including them. A typical filter is a steric filter to ignore all conformers with atoms to close together.</p>
<p>For each generation, numChildren children are created by permuting the parent rotor keys. The mutability setting determines how frequent a permutation is made (e.g. 5 means 1/5 bonds are permuted, 10 means 1/10). Again, duplicated and filtered molecules are ignored. The population now contains up to numConformer * (1 + numChildren). All these rotor keys are scored using the specified <a class="el" href="classOpenBabel_1_1OBConformerScore.shtml" title="Interface used by OBConformerSearch for scoring conformers. ">OBConformerScore</a> class. Next, all keys are ordered by their score and the best numConformers conformers are selected as parents for the next generation.</p>
<p>New generations are generated until the specified number of generations (i.e. convergence) don't improve the score.</p>
<h2><a class="anchor" id="OBConformerFilter"></a>
OBConformerFilter</h2>
<p>Filters are used to exclude certain generated conformers. For example, the <a class="el" href="classOpenBabel_1_1OBStericConformerFilter.shtml" title="A steric conformer filter class. ">OBStericConformerFilter</a> filters out all conformers with atoms to close together. Custom filters can be used to consider additional properties (e.g. electrostatic energy, distance between pharmacophore groups, ...). Filters can easily be combined using the <a class="el" href="classOpenBabel_1_1OBConformerFilters.shtml" title="Class for combining OBConformerFilter objects. ">OBConformerFilters</a> class.</p>
<h2><a class="anchor" id="OBConformerScore"></a>
OBConformerScore</h2>
<p><a class="el" href="classOpenBabel_1_1OBConformerScore.shtml" title="Interface used by OBConformerSearch for scoring conformers. ">OBConformerScore</a> derived classes compute the score for conformers. The scoring function is probably the most important part of the algorithm since it selects which conformers will be used as parents for the next generation. Derived classes also specify if the scores are descending or ascending and what convergence criteria should be used (i.e. lowest, highest, sum or average). There is no easy way to combine scoring functions since scores are not always additive. However, a custom scoring function could be used that combines several other scoring functions with weights for each score.</p>
<p>The scoring function determines what kind of conformers are selected. For example, the <a class="el" href="classOpenBabel_1_1OBEnergyConformerScore.shtml" title="A lowest energy conformer scoring class. ">OBEnergyConformerScore</a> class selects stable, low energy conformers. A simple variation to this would be to only use the non-bonded energy. The result for these two scoring functions should be similar.</p>
<p>The <a class="el" href="classOpenBabel_1_1OBRMSDConformerScore.shtml" title="A RMSD conformer scoring class. ">OBRMSDConformerScore</a> scoring function can be used to generate a diverse set of conformers. A diverse set is often useful when screening bioactive molecules since the interaction with the target can stabilize a higher conformational energy. To calculate the RMSD between conformers, Kabsch alignment (<a class="el" href="classOpenBabel_1_1OBAlign.shtml" title="Perform a least-squares alignment of two molecules or two vectors of vector3 objects. ">OBAlign</a>) is used. The alignment takes symmetry into account.</p>
<div class="image">
<img src="energyconformerscore.png" alt="energyconformerscore.png"/>
</div>
 <div class="image">
<img src="rmsdconformerscore.png" alt="rmsdconformerscore.png"/>
<div class="caption">
30 Conformers for methotrexate. top: OBEnergyConformerScore bottom: OBRMSDConformerScore</div></div>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Oct 15 2019 21:28:04 for Open Babel by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
